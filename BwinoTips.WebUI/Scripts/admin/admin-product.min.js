function UpdateExclusion(t) { var a = "/Cart/Exclude/" + t; $.post(a, function (t) { $("#total-discount").val(t.discount), parseAmount(t.total, "#cart-total") }) } function AddToCart(t, a) { var e; toastr.options = { closeButton: !1, debug: !1, newestOnTop: !1, progressBar: !1, positionClass: "toast-bottom-right", preventDuplicates: !1, showDuration: "800", hideDuration: "1000", timeOut: "5000", extendedTimeOut: "1000", showEasing: "swing", hideEasing: "linear", showMethod: "fadeIn", hideMethod: "fadeOut" }, e = t > 0 && a > 0 ? "/Cart/Add/" + t + "/" + a : "", $.post(e, function (t) { $("#cart_holder").html(t), toastr.success("Item added successfully.") }) } function AddTo(t, a) { var e; e = t > 0 && a > 0 ? "/Cart/AddItem/" + t + "/" + a : "", $.post(e, function (a) { "string" === jQuery.type(a) && a.indexOf("exceeds") >= 0 ? alert(a) : ($("#myBody tr").each(function () { var a = $(this).data("ExclusiveTipId"); parseInt(a) === parseInt(t) && $(this).remove() }), $("#myBody").prepend(a.view), parseAmount(a.total, "#cart-total"), $("#total-discount").val(a.discount), $("#FormExclusiveTipId").val(""), $("#searchitem").val(""), $("#formunitpx").val("")), $("#formquantity").val("1") }) } function Update(t, a, e, o) { var i, n = 0; t > 0 && a > -1 ? 1 === e ? (i = "/Cart/" + t + "/" + a + "/Qty", n = 1) : i = "/Cart/" + t + "/" + a + "/" + o + "/Disc" : i = 3 === e && a > -1 ? "/Cart/Discount/" + a : "", $.post(i, function (a) { "string" === jQuery.type(a) && a.indexOf("exceeds") >= 0 ? alert(a) : (t > 0 && parseAmount(a.cost, "#total-" + t), 1 === n && $("#total-discount").val(a.discount), parseAmount(a.total, "#cart-total")) }) } function parseAmount(t, a) { $amount = $(a), $($amount).empty(), $($amount).html(t) } $(function () { $("#myBody").on("change", ".cart-disc", function () { Update($(this).data("ExclusiveTipId"), $(this).val(), 2, 1) }), $("#myBody").on("change", ".cart-deduct", function () { Update($(this).data("ExclusiveTipId"), $(this).val(), 2, 0) }), $("#myBody").on("change", ".cart-qty", function () { Update($(this).data("ExclusiveTipId"), $(this).val(), 1) }), $("body").on("change", "#ExcludeDiscount", function () { UpdateExclusion(!!$("#ExcludeDiscount").is(":checked")) }), $("body").on("click", ".add-product", function () { var t = $(this).closest("tr").find(".quantity").val(); t > 0 ? (AddToCart($(this).data("exclusivetipid"), t), $(this).closest("tr").find(".quantity").val("1")) : alert("Quantity must be greater 0!") }), $("body").on("click", "#formbtn", function () { var t = $("#FormExclusiveTipId").val(), a = $(this).closest("tr").find("#formquantity").val(); a > 0 && t > 0 ? AddTo(t, a) : alert("Quantity must be greater 0!") }), $("body").on("click", "#updatebtn", function () { var t = $("#SessionCode").val(), a = $("#FormExclusiveTipId").val(), e = $("#FormSupplierId").val(), o = $("#formunitpx").val(), i = $("#formquantity").val(), n = $("#Date").val(), s = $("#ImportId").val(); a <= 0 && alert("Please select a product"), e <= 0 && alert("Please select a supplier"), o <= 0 && alert("Please enter the purchase price"), i <= 0 && alert("Quantity must be greater 0!"), "" === n && alert("Please select a date"), "" === s && (s = 0); var r = "/StockUpdates/Add/" + a + "/" + e + "/" + o + "/" + i + "/" + n + "/" + t + "/" + s; $.post(r, function (t) { "string" === jQuery.type(t) && t.indexOf("exceeds") >= 0 ? alert(t) : ($("#myBody").prepend(t.view), $("#FormExclusiveTipId").val(""), $("#FormSupplierId").val(""), $("#searchitem").val(""), $("#searchsupplier").val(""), $("#formunitpx").val("")), $("#formquantity").val("1") }) }), $("#total-discount").change(function () { Update(0, $(this).val(), 3, 0) }) });